<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.105.0">
    <meta name="description" content="A model of the MSI cache coherency protocol.">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>ABS Model of a Multicore Memory System :: The ABS Modeling Language</title>

    
    <link href="/css/nucleus.css?1668441152" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1668441152" rel="stylesheet">
    <link href="/css/hybrid.css?1668441152" rel="stylesheet">
    <link href="/css/featherlight.min.css?1668441152" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1668441152" rel="stylesheet">
    <link href="/css/auto-complete.css?1668441152" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1668441152" rel="stylesheet">
    <link href="/css/theme.css?1668441152" rel="stylesheet">
    <link href="/css/tabs.css?1668441152" rel="stylesheet">
    <link href="/css/hugo-theme.css?1668441152" rel="stylesheet">
    
    <link href="/css/theme-abs.css?1668441152" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1668441152"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/documentation/examples/multicore_memory/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://abs-models.org/" >
  <img src='/images/ABS_logo_colors.png' width="80%">
  </img>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1668441152"></script>
<script type="text/javascript" src="/js/auto-complete.js?1668441152"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/abs-models.org\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1668441152"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/overview/" title="Overview" class="dd-item
        
        
        
        ">
      <a href="/overview/">
          Overview
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/getting_started/" title="Getting Started" class="dd-item
        
        
        
        ">
      <a href="/getting_started/">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/getting_started/local-install/" title="Installing Command-Line Tools" class="dd-item ">
        <a href="/getting_started/local-install/">
        Installing Command-Line Tools
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/getting_started/docker/" title="Running a Browser-Based IDE" class="dd-item ">
        <a href="/getting_started/docker/">
        Running a Browser-Based IDE
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/getting_started/editor-support/" title="Installing Editor Support" class="dd-item ">
        <a href="/getting_started/editor-support/">
        Installing Editor Support
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/documentation/" title="Documentation" class="dd-item
        parent
        
        
        ">
      <a href="/documentation/">
          Documentation
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/documentation/examples/" title="Examples" class="dd-item
        parent
        
        
        ">
      <a href="/documentation/examples/">
          Examples
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/documentation/examples/monty-hall/" title="The Monty Hall Problem" class="dd-item ">
        <a href="/documentation/examples/monty-hall/">
        The Monty Hall Problem
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/documentation/examples/time-and-date/" title="Modeling and Visualizing Calendar Time" class="dd-item ">
        <a href="/documentation/examples/time-and-date/">
        Modeling and Visualizing Calendar Time
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/documentation/examples/single-watertank/" title="Modeling and Visualizing A Water Tank Controller" class="dd-item ">
        <a href="/documentation/examples/single-watertank/">
        Modeling and Visualizing A Water Tank Controller
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/documentation/examples/multicore_memory/" title="ABS Model of a Multicore Memory System" class="dd-item active">
        <a href="/documentation/examples/multicore_memory/">
        ABS Model of a Multicore Memory System
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/documentation/tutorials/" title="Tutorials" class="dd-item
        
        
        
        ">
      <a href="/documentation/tutorials/">
          Tutorials
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/documentation/tutorials/language-tutorial/" title="Language Tutorial" class="dd-item ">
        <a href="/documentation/tutorials/language-tutorial/">
        Language Tutorial
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/documentation/tutorials/resources/" title="Resource Modeling Tutorial" class="dd-item ">
        <a href="/documentation/tutorials/resources/">
        Resource Modeling Tutorial
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/documentation/tutorials/costabs/" title="Resource Analysis with CostABS" class="dd-item ">
        <a href="/documentation/tutorials/costabs/">
        Resource Analysis with CostABS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/documentation/tutorials/mhp/" title="May-Happen-in-Parallel Analysis" class="dd-item ">
        <a href="/documentation/tutorials/mhp/">
        May-Happen-in-Parallel Analysis
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/documentation/tutorials/sra/" title="Resource Analysis with SRA" class="dd-item ">
        <a href="/documentation/tutorials/sra/">
        Resource Analysis with SRA
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/publications/" title="Publications and Workshops" class="dd-item
        
        
        
        ">
      <a href="/publications/">
          Publications and Workshops
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/contact/" title="Contact" class="dd-item
        
        
        
        ">
      <a href="/contact/">
          Contact
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/acknowledgments/" title="Acknowledgments" class="dd-item
        
        
        
        ">
      <a href="/acknowledgments/">
          Acknowledgments
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/laboratory/" title="The Collaboratory" class="dd-item
        
        
        
        ">
      <a href="/laboratory/">
          The Collaboratory
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="footer">
      <ul class="topics"><li class="dd-item" title="Language Manual"><a href="/manual/">Language Manual</a></li></ul>
<br/>
<p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>The ABS Language</a> > <a href='/documentation/'>Documentation</a> > <a href='/documentation/examples/'>Examples</a> > ABS Model of a Multicore Memory System
          
        
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#model-configurations">Model configurations</a></li>
    <li><a href="#running-the-simulation-with-penalties">Running the simulation with penalties</a></li>
    <li><a href="#running-the-simulation-without-penalties">Running the simulation without penalties</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              ABS Model of a Multicore Memory System
            </h1>
          

        


<p>A multicore memory system consists of cores that contain tasks to be executed,
the data layout in main memory (indicating where data is allocated), and a
system architecture consisting of cores with private multi-level caches and
shared memory (see Figure 1). Such a system is parametric in the number of
cores, the number and size of caches, and the associativity and replacement
policy.  Data is organised in blocks that move between the caches and the main
memory.  For simplicity, we abstract from the data content of the memory
blocks, assume that the size of cache lines and memory blocks in main memory
coincide and transfer memory blocks from the caches of one core to the caches
of another core via the main memory. As a consequence, the tasks executed in
the cores are represented as data access patterns, abstracting from their
computational content.</p>
<p>The complete code can be found at
<a href="https://github.com/abstools/absexamples/tree/master/collaboratory/case_studies/Multicore_Model/">https://github.com/abstools/absexamples/tree/master/collaboratory/case_studies/Multicore_Model/</a></p>
<table>
<thead>
<tr>
<th style="text-align:center"><img src="/images/examples/multicore_memory/cores.png" alt="Figure cores.png"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><!-- raw HTML omitted -->Figure 1<!-- raw HTML omitted -->: System memory architecture</td>
</tr>
</tbody>
</table>
<p>Task execution on a core requires memory blocks to be transferred from the
main memory to the closest cache.  Each cache has a pool of instructions to
move memory blocks among caches and between caches and main memory. Memory
blocks may exist in multiple copies in the memory system.  Consistency between
different copies of a memory block is ensured using the standard <a href="https://en.wikipedia.org/wiki/MSI_protocol">cache
coherence protocol MSI</a>, with
which a cache line can be either modified, shared or invalid.  A modified
cache line has the most recent value of the memory block, therefore all other
copies are invalid (including the one in main memory). A shared cache line
indicates that all copies of the block are consistent.  The protocol&rsquo;s
messages are broadcasted to the cores.  Following standard nomenclature, <code>Rd</code>
messages request read access and <code>RdX</code> messages read exclusive access to a
memory block. The latter invalidates other copies of the same block in other
caches to provide write access.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><img src="/images/examples/multicore_memory/initialConfiguration.png" alt="Figure initialConfiguration.png"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><!-- raw HTML omitted -->Figure 2<!-- raw HTML omitted -->: ABS model structure</td>
</tr>
</tbody>
</table>
<p>This use-case contains a distributed implementation of this model in ABS (see
Figure 2). A transition system specification of this model can be found at
<a href="https://doi.org/10.1016/j.scico.2019.04.003">https://doi.org/10.1016/j.scico.2019.04.003</a></p>
<p>We have two versions of the model which can run with different initial
configurations:</p>
<ul>
<li><code>withoutPenaltiesSimplified</code>:  no collection of penalties</li>
<li><code>withPenaltiesSimplified</code>: collection of hits and penalties. Hits count the
number of times a memory block was found in the caches.  Penalties vary
(from 1,10, 100, etc.) depending from where in the memory system the memory
block was accessed.  The further down the data is accessed in the memory
system, the higher the penalty.</li>
</ul>
<h2 id="model-configurations">Model configurations</h2>
<p>All the configurations have 4 cores with three levels of caches,
but they are varying in the number, size and access patterns of the tasks.</p>
<ul>
<li>
<p><strong>Config1</strong>:</p>
<p>Contains 10 tasks with 100 read/write instructions each.  It has one access
per memory block, where all the tasks do not share any block during
execution.</p>
</li>
<li>
<p><strong>Config2</strong>:</p>
<p>Contains 10 tasks with 100 read/write instructions each.  Tasks interleaves
between a read and a write with one access per memory block.  Each task
shares with the next task 1/4 of its blocks.</p>
</li>
<li>
<p><strong>Config3</strong>:</p>
<p>Contains 10 tasks with 100 read/write instructions each.  Task interleaves
between a read and a write to the same memory block, therefore each task has
two accesses read/write per memory block.  All the tasks do not share any
block between them during execution.</p>
</li>
<li>
<p><strong>Config4</strong>:</p>
<p>Contains 10 identical tasks with a loop accessing one memory block many
times. Since all the cores access a single memory block many times, the
execution generates congestion.</p>
</li>
</ul>
<h2 id="running-the-simulation-with-penalties">Running the simulation with penalties</h2>
<pre tabindex="0"><code>absc --erlang common/*.abs  withPenalties/*.abs  configs/ConfigX.abs
./gen/erl/run
</code></pre><p>Where <code>X</code> correspond to which initial configuration is chosen.</p>
<p>Example output of running <strong>Config4</strong>:</p>
<pre tabindex="0"><code>C1: hits = 10; penalties = 120
C2: hits = 10; penalties = 1220
C3: hits = 10; penalties = 2210
C4: hits = 10; penalties = 3090
</code></pre><h2 id="running-the-simulation-without-penalties">Running the simulation without penalties</h2>
<pre tabindex="0"><code>absc --erlang common/*.abs  withoutPenalties/*.abs  configs/ConfigX.abs
./gen/erl/run
</code></pre><p>Example output of running <strong>Config1</strong>:</p>
<pre tabindex="0"><code>Execution has terminated
</code></pre>

<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/documentation/examples/single-watertank/" title="Modeling and Visualizing A Water Tank Controller"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/documentation/tutorials/" title="Tutorials" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1668441152"></script>
    <script src="/js/perfect-scrollbar.min.js?1668441152"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1668441152"></script>
    <script src="/js/jquery.sticky.js?1668441152"></script>
    <script src="/js/featherlight.min.js?1668441152"></script>
    <script src="/js/highlight.pack.js?1668441152"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1668441152"></script>
    <script src="/js/learn.js?1668441152"></script>
    <script src="/js/hugo-learn.js?1668441152"></script>
    
        
            <script src="/mermaid/mermaid.js?1668441152"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </body>
</html>

