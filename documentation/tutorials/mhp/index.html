<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.93.0" />
    <meta name="description" content="The maypar static analysis tool finds pairs of program statements that possibly execute in parallel.">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>May-Happen-in-Parallel Analysis :: The ABS Modeling Language</title>

    
    <link href="/css/nucleus.css?1646219168" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1646219168" rel="stylesheet">
    <link href="/css/hybrid.css?1646219168" rel="stylesheet">
    <link href="/css/featherlight.min.css?1646219168" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1646219168" rel="stylesheet">
    <link href="/css/auto-complete.css?1646219168" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1646219168" rel="stylesheet">
    <link href="/css/theme.css?1646219168" rel="stylesheet">
    <link href="/css/tabs.css?1646219168" rel="stylesheet">
    <link href="/css/hugo-theme.css?1646219168" rel="stylesheet">
    
    <link href="/css/theme-abs.css?1646219168" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1646219168"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/documentation/tutorials/mhp/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://abs-models.org/" >
  <img src='/images/ABS_logo_colors.png' width="80%">
  </img>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1646219168"></script>
<script type="text/javascript" src="/js/auto-complete.js?1646219168"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/abs-models.org\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1646219168"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/overview/" title="Overview" class="dd-item
        
        
        
        ">
      <a href="/overview/">
          Overview
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/getting_started/" title="Getting Started" class="dd-item
        
        
        
        ">
      <a href="/getting_started/">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/getting_started/local-install/" title="Installing Command-Line Tools" class="dd-item ">
        <a href="/getting_started/local-install/">
        Installing Command-Line Tools
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/getting_started/docker/" title="Running a Browser-Based IDE" class="dd-item ">
        <a href="/getting_started/docker/">
        Running a Browser-Based IDE
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/getting_started/editor-support/" title="Installing Editor Support" class="dd-item ">
        <a href="/getting_started/editor-support/">
        Installing Editor Support
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/documentation/" title="Documentation" class="dd-item
        parent
        
        
        ">
      <a href="/documentation/">
          Documentation
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/documentation/examples/" title="Examples" class="dd-item
        
        
        
        ">
      <a href="/documentation/examples/">
          Examples
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/documentation/examples/monty-hall/" title="The Monty Hall Problem" class="dd-item ">
        <a href="/documentation/examples/monty-hall/">
        The Monty Hall Problem
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/documentation/examples/time-and-date/" title="Modeling and Visualizing Calendar Time" class="dd-item ">
        <a href="/documentation/examples/time-and-date/">
        Modeling and Visualizing Calendar Time
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/documentation/examples/single-watertank/" title="Modeling and Visualizing A Water Tank Controller" class="dd-item ">
        <a href="/documentation/examples/single-watertank/">
        Modeling and Visualizing A Water Tank Controller
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/documentation/examples/multicore_memory/" title="ABS Model of a Multicore Memory System" class="dd-item ">
        <a href="/documentation/examples/multicore_memory/">
        ABS Model of a Multicore Memory System
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/documentation/tutorials/" title="Tutorials" class="dd-item
        parent
        
        
        ">
      <a href="/documentation/tutorials/">
          Tutorials
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/documentation/tutorials/language-tutorial/" title="Language Tutorial" class="dd-item ">
        <a href="/documentation/tutorials/language-tutorial/">
        Language Tutorial
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/documentation/tutorials/resources/" title="Resource Modeling Tutorial" class="dd-item ">
        <a href="/documentation/tutorials/resources/">
        Resource Modeling Tutorial
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/documentation/tutorials/costabs/" title="Resource Analysis with CostABS" class="dd-item ">
        <a href="/documentation/tutorials/costabs/">
        Resource Analysis with CostABS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/documentation/tutorials/mhp/" title="May-Happen-in-Parallel Analysis" class="dd-item active">
        <a href="/documentation/tutorials/mhp/">
        May-Happen-in-Parallel Analysis
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/documentation/tutorials/sra/" title="Resource Analysis with SRA" class="dd-item ">
        <a href="/documentation/tutorials/sra/">
        Resource Analysis with SRA
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/publications/" title="Publications and Workshops" class="dd-item
        
        
        
        ">
      <a href="/publications/">
          Publications and Workshops
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/contact/" title="Contact" class="dd-item
        
        
        
        ">
      <a href="/contact/">
          Contact
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/acknowledgments/" title="Acknowledgments" class="dd-item
        
        
        
        ">
      <a href="/acknowledgments/">
          Acknowledgments
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/laboratory/" title="The Collaboratory" class="dd-item
        
        
        
        ">
      <a href="/laboratory/">
          The Collaboratory
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="footer">
      <ul class="topics"><li class="dd-item" title="Language Manual"><a href="/manual/">Language Manual</a></li></ul>
<br/>
<p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>The ABS Language</a> > <a href='/documentation/'>Documentation</a> > <a href='/documentation/tutorials/'>Tutorials</a> > May-Happen-in-Parallel Analysis
          
        
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li><a href="#headline-1">May-Happen-in-Parallel Analysis (MHP)</a>
<ul>
<li><a href="#headline-2">MHP Analysis in the Collaboratory</a>
</li>
<li><a href="#headline-3">MHP Settings</a>
</li>
<li><a href="#headline-4">May-Happen-in-Parallel with Inter-Procedural Synchronization</a>
</li>
</ul>
</li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              May-Happen-in-Parallel Analysis
            </h1>
          

        



<div id="outline-container-headline-1" class="outline-3">
<h3 id="headline-1">
May-Happen-in-Parallel Analysis (MHP)
</h3>
<div id="outline-text-headline-1" class="outline-text-3">
<p>
ABS is a distributed language where different methods can be invoked
asynchronously.  Therefore, there can be several tasks executing their code at
the same time.  This simultaneity complicates the analysis and understanding
of ABS programs, since (in general) there is a high level of parallelism.  The
MHP analysis alleviates this situation by computing, for each instruction,
which other instructions could execute in parallel.  This information can be
very interesting for developers and testers, but it is crucial for the
precision of many of the SACO analyses presented in the <a href="../costabs">CostABS tutorial</a>.</p>
<p>
The result of the MHP analysis, described in the paper <a href="http://dx.doi.org/10.1007/978-3-642-30793-5_3">“Analysis of
May-Happen-in-Parallel in Concurrent Objects”</a>, is a set of pairs of
instructions that could execute in parallel in any execution of the program.
It is important to stress that this analysis computes an <em>overapproximation</em>
of the parallelism.  In other words, if a pair of instruction can execute in
parallel, then they will be detected by the analysis; however, the analysis
can incorrectly detect pairs of instructions that never execute in parallel
when executing the program.</p>
<div id="outline-container-headline-2" class="outline-4">
<h4 id="headline-2">
MHP Analysis in the Collaboratory
</h4>
<div id="outline-text-headline-2" class="outline-text-4">
<p>
In order to apply the MHP Analysis in the Collaboratory, just:</p>
<ul>
<li>Open the ABS program to analyze.</li>
<li>Select <code>MHP Analysis</code> in the list of analyses.</li>
<li>Refresh the list of methods in the right side (button <code>Refresh Outline</code>) and select the entry point of the analysis.  Only one method or function can be selected as entry point.  If none is selected then the main block will be considered the entry point.</li>
<li>Press the <code>Run</code> button.</li>
</ul>
<p>Let us see the results of the MHP analysis in the 





<a href="http://ei.abs-models.org:8082/clients/web/index.html?file=/collaboratory/deliverables/D3.3.2/VendingMachine.abs&app=mhp" target="_blank">VendingMachine.abs</a>

 program selecting the <code>main</code> method from class <code>IMain</code> as the entry point.  The analysis reports its results in two places.  First, all the pairs of instructions that can be executed in parallel are printed in the console. This information is very detailed and verbose, but difficult to understand:</p>
<pre class="example">
...
L28 (Await)[IVendingMachine.insertCoins(-[2,&#39;IMain.main&#39;]-)]  ||  L37 (Await)[IVendingMachine.retrieveCoins(-[2,&#39;IMain.main&#39;]-)]

L20 (Entry)[IVendingMachine.insertCoin(-[2,&#39;IMain.main&#39;]-)]  ||  L60 (Exit)[IMain.main(-[&#39;IMain.main&#39;]-)]
...
</pre>
<p>
The previous fragment shows that the instruction at L28 (the <code>await</code> instruction in method <code>insertCoins</code>) can happen in parallel with the instruction at L37 (the <code>await</code> instruction in method <code>retrieveCoins</code>), and the same for instructions at L20 and L60.  However, the most comfortable way of inspecting the results of the MHP analysis is by navigating the code.  Every considered instruction will have a blue arrow in its left margin.  When clicking the arrow of an instruction, all the other considered instructions that can happen in parallel with it will be highlighted in yellow.  For example, clicking on the arrow in L37 will show the instructions that can happen in parallel with it, which as expected include L28.  We have mentioned “considered instruction” because, by default, the MHP analysis only takes into account those instructions that are entry/exit points of methods and <code>await</code> or <code>release</code> instructions.  In order to obtain the full list of instructions that may happen in parallel, open the settings window (button <code>Settings</code>, option <code>MHP analysis</code>) and change the option <code>Amount of considered points</code> from <code>Reduced</code> to <code>Full</code>.  With these new settings the analysis obtains the MHP information for all the instructions in the program.</p>
<p>
Since the MHP analysis is a sound overapproximation, instructions that cannot execute in parallel are never detected.  For example, due to the <code>await</code> instruction at L57, the task <code>retrieveCoins</code> must be finished before continuing.  Therefore, the <code>await</code> instruction at L37, which is inside <code>retrieveCoins</code>, cannot happen in parallel with the instructions after the <code>await</code> (L58 and L59) or the method <code>showIncome</code> that is invoked at L59.  If we execute a full MHP analysis and select the arrow at L37, those fragments will not be highlighted.</p>
</div>
</div>
<div id="outline-container-headline-3" class="outline-4">
<h4 id="headline-3">
MHP Settings
</h4>
<div id="outline-text-headline-3" class="outline-text-4">
<p>
In addition to the Amount of considered points to compute all the pairs of instructions that can execute in parallel or only a the most important, the MHP analysis supports other important settings, as shown in the next figure:</p>
<p>
<figure class="image main"><img src="/images/tutorials/costabs/mhp_settings.png"/>
</figure>
</p>
<p>
Using these parameters we can adapt the behavior of the analysis:</p>
<ul>
<li><code>Debug information</code> (<code>0</code>, <code>1</code>, or <code>2</code>): level of information that is printed in the console, where <code>0</code> is the lowest level.</li>
<li><code>Points-to analysis precision</code> (<code>1</code>, <code>2</code>, <code>3</code> and <code>4</code>): the precision that will be used in the point-to analysis that approximates the different objects that are created during execution.</li>
<li><code>Condition synchronization MHP extension</code> (<code>no</code>, <code>yes</code>): by default, the MHP analysis only considers simple await instructions involving one future variable (<code>await f?;</code>).  When enabling this option, the analysis tries to use the information from <code>await</code> instructions that involve complex conditions like <code>await this.x != null</code>.</li>
<li>
<p><code>Inter-Procedural Synchronization</code> (<code>no</code>, <code>yes</code>): enables a refinement of the MHP analysis that obtains finer information about the finished task, thus producing more precise results in programs with inter-procedural synchronization.</p>
</li>
</ul>
</div>
</div>
<div id="outline-container-headline-4" class="outline-4">
<h4 id="headline-4">
May-Happen-in-Parallel with Inter-Procedural Synchronization
</h4>
<div id="outline-text-headline-4" class="outline-text-4">
<p>
Let us analyze with SACO the program 





<a href="http://ei.abs-models.org:8082/clients/web/index.html?file=/collaboratory/deliverables/D3.3.2/InterProcedural.abs&app=mhp" target="_blank">InterProcedural.abs</a>

 with the Inter-Procedural Synchronization of the MHP analysis (described in the paper <a href="http://dx.doi.org/10.1007/978-3-662-48288-9_5">May-Happen-in-Parallel Analysis for Asynchronous Programs with Inter-Procedural Synchronization</a>), as mentioned before.</p>
<div class="src src-abs">
<pre tabindex="0"><code class="language-abs" data-lang="abs">module Parallel;
import * from ABS.StdLib;

interface IO1 {
    Unit f ();
}

interface IO2 {
    Unit g (Fut&lt;Unit&gt; w);
}

class O1 implements IO1 {
    Unit f () {
        skip;
    }
}

class O2 implements IO2 {
    Unit g (Fut&lt;Unit&gt; w) {
        skip;
        await w?;
        skip;
    }
}

{
    Fut&lt;Unit&gt; x;
    Fut&lt;Unit&gt; y;
    IO1 o1 = new local O1();
    IO2 o2 = new local O2();
    x = o1!f();
    y = o2!g(x);
    await y?;
}</code></pre>
</div>
<p>
If we apply the MHP analysis without inter-procedural synchronization, we
obtain that L14 can happen in parallel with L34 because the analysis is not
able to infer that when method <code>g</code> finishes its execution, method <code>f</code> has finished
too (caused by the await instruction in L21).</p>
<p>
To refine the MHP analysis, we set the option <code>Inter-Procedural
Synchronization</code> to <code>yes</code>.  Using this refinement we obtain that the only
program points that can happen in parallel with L34 are the end of methods <code>f</code>
and <code>g</code>, which means that both methods must have finished when L34 is reached.</p>
</div>
</div>
</div>
</div>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/documentation/tutorials/costabs/" title="Resource Analysis with CostABS"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/documentation/tutorials/sra/" title="Resource Analysis with SRA" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1646219168"></script>
    <script src="/js/perfect-scrollbar.min.js?1646219168"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1646219168"></script>
    <script src="/js/jquery.sticky.js?1646219168"></script>
    <script src="/js/featherlight.min.js?1646219168"></script>
    <script src="/js/highlight.pack.js?1646219168"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1646219168"></script>
    <script src="/js/learn.js?1646219168"></script>
    <script src="/js/hugo-learn.js?1646219168"></script>
    
        
            <script src="/mermaid/mermaid.js?1646219168"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </body>
</html>

